<section class="hero">
    <div class="hero__header">
      <p class="hero__subtitle">Зеркало</p>
      <h1 class="hero__title">CLARUSO</h1>
      <div class="hero__pagination desktop" data-hero-pagination aria-label="Пагинация вариантов"></div>
    <div class="hero__palette desktop" data-hero-palette></div>
    </div>

    <div class="hero__visual">
      <button class="hero__nav hero__nav--prev" type="button" aria-label="Предыдущий вариант">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="8" viewBox="0 0 18 8" fill="none">
          <path d="M17 3.76575C17.2761 3.76575 17.5 3.9896 17.5 4.26575C17.5 4.54189 17.2761 4.76575 17 4.76575V4.26575V3.76575ZM0.646447 4.6193C0.451184 4.42404 0.451184 4.10746 0.646447 3.91219L3.82843 0.730213C4.02369 0.534951 4.34027 0.534951 4.53553 0.730213C4.7308 0.925475 4.7308 1.24206 4.53553 1.43732L1.70711 4.26575L4.53553 7.09417C4.7308 7.28944 4.7308 7.60602 4.53553 7.80128C4.34027 7.99654 4.02369 7.99654 3.82843 7.80128L0.646447 4.6193ZM17 4.26575V4.76575H1V4.26575V3.76575H17V4.26575Z" fill="white"/>
        </svg>
      </button>

      <div class="hero__stage">
        <img class="hero__image" src="" alt="CLARUSO" data-hero-image>
      </div>

      <button class="hero__nav hero__nav--next" type="button" aria-label="Следующий вариант">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="8" viewBox="0 0 18 8" fill="none">
          <path d="M0.935913 3.76575C0.659771 3.76575 0.435913 3.9896 0.435913 4.26575C0.435913 4.54189 0.659771 4.76575 0.935913 4.76575V4.26575V3.76575ZM17.2895 4.6193C17.4847 4.42404 17.4847 4.10746 17.2895 3.91219L14.1075 0.730213C13.9122 0.534951 13.5956 0.534951 13.4004 0.730213C13.2051 0.925475 13.2051 1.24206 13.4004 1.43732L16.2288 4.26575L13.4004 7.09417C13.2051 7.28944 13.2051 7.60602 13.4004 7.80128C13.5956 7.99654 13.9122 7.99654 14.1075 7.80128L17.2895 4.6193ZM0.935913 4.26575V4.76575H16.9359V4.26575V3.76575H0.935913V4.26575Z" fill="white"/>
        </svg>
      </button>
    </div>

    <div class="hero__pagination mob" data-hero-pagination aria-label="Пагинация вариантов"></div>
    <div class="hero__palette mob" data-hero-palette></div>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const slides = [
        {
          image: 'https://raw.githubusercontent.com/weareneture/valonti/refs/heads/main/catalog/item%20page/hero/claruso/claruso-hero-1.png',
          palette: [
            {
              image: 'https://raw.githubusercontent.com/weareneture/valonti/refs/heads/main/catalog/item%20page/materials/stone/smart-quartz/02.jpg',
              color: '#1c1c1c',
              title: 'Столешница',
              desc: 'Агломерат: Smart Quartz Calacatta Sun'
            },
          ],
        },
        {
          image: 'https://raw.githubusercontent.com/weareneture/valonti/refs/heads/main/catalog/item%20page/hero/claruso/claruso-hero-2.png',
          palette: [
            {
              image: 'https://raw.githubusercontent.com/weareneture/valonti/refs/heads/main/catalog/item%20page/materials/stone/laminam/09.jpg',
              color: '#f2f2f2',
              title: 'Столешница',
              desc: 'Керамогранит: Laminam Nero Greco'
            },
          ],
        },
        {
          image: 'https://raw.githubusercontent.com/weareneture/valonti/refs/heads/main/catalog/item%20page/hero/claruso/claruso-hero-3.png',
          palette: [
            {
              image: 'https://raw.githubusercontent.com/weareneture/valonti/refs/heads/main/catalog/item%20page/materials/glass/10.jpg',
              color: '#1c1c1c',
              title: 'Столешница',
              desc: 'Стекло: тонированное MATELUX (Soft Touch)'
            },
          ],
        },
      ];
  
      const imageEl = document.querySelector('[data-hero-image]');
      const paletteEls = document.querySelectorAll('[data-hero-palette]');
      const paginationEls = document.querySelectorAll('[data-hero-pagination]');
      const prevBtn = document.querySelector('.hero__nav--prev');
      const nextBtn = document.querySelector('.hero__nav--next');
      const stageEl = document.querySelector('.hero__stage');
  
      let active = 0;
      let isAnimating = false;
  
      const updatePagination = () => {
        paginationEls.forEach((paginationEl) => {
          if (!paginationEl) return;
          const dots = paginationEl.querySelectorAll('.hero__dot');
          dots.forEach((dot, idx) => {
            const isActive = idx === active;
            dot.classList.toggle('is-active', isActive);
            if (isActive) {
              dot.setAttribute('aria-current', 'true');
            } else {
              dot.removeAttribute('aria-current');
            }
          });
        });
      };
  
      const renderPagination = () => {
        paginationEls.forEach((paginationEl) => {
          if (!paginationEl) return;
          paginationEl.innerHTML = '';

          slides.forEach((_, idx) => {
            const dot = document.createElement('button');
            dot.type = 'button';
            dot.className = 'hero__dot';
            dot.setAttribute('aria-label', `Вариант ${idx + 1}`);
            dot.addEventListener('click', () => {
              if (idx === active) return;
              const direction = idx > active ? 'next' : 'prev';
              animateTo(idx, direction);
            });
            paginationEl.appendChild(dot);
          });
        });

        updatePagination();
      };
  
      const renderPalette = (palette) => {
        paletteEls.forEach((paletteEl) => {
          if (!paletteEl) return;
          paletteEl.innerHTML = '';
          palette.forEach((item) => {
            const swatch = document.createElement('button');
            swatch.className = 'hero__swatch';
            swatch.type = 'button';
            if (item.color) swatch.style.setProperty('--swatch-color', item.color);
            if (item.image) swatch.style.setProperty('--swatch-image', `url('${item.image}')`);
            swatch.innerHTML = `
              <span class="hero__swatch-dot"></span>
              <span class="hero__swatch-tooltip">
                <span class="hero__swatch-title">${item.title}</span>
                <span class="hero__swatch-desc">${item.desc}</span>
              </span>
            `;
            paletteEl.appendChild(swatch);
          });
        });
      };
  
      const renderSlideInstant = (index) => {
        const slide = slides[index];
        imageEl.src = slide.image;
        renderPalette(slide.palette);
        updatePagination();
      };
  
      const animateTo = (nextIndex, direction) => {
        if (isAnimating || nextIndex === active) return;
        isAnimating = true;
  
        const outClass = direction === 'next' ? 'hero__image--out-left' : 'hero__image--out-right';
        const inClass = direction === 'next' ? 'hero__image--in-right' : 'hero__image--in-left';
  
        const handleOutEnd = () => {
          imageEl.removeEventListener('animationend', handleOutEnd);
          imageEl.classList.remove(outClass);
  
          active = nextIndex;
          const slide = slides[active];
          imageEl.src = slide.image;
          renderPalette(slide.palette);
          updatePagination();
  
          imageEl.classList.add(inClass);
          imageEl.addEventListener('animationend', handleInEnd, { once: true });
        };
  
        const handleInEnd = () => {
          imageEl.classList.remove(inClass);
          isAnimating = false;
        };
  
        imageEl.addEventListener('animationend', handleOutEnd);
        imageEl.classList.add(outClass);
      };
  
      const goPrev = () => {
        const next = (active - 1 + slides.length) % slides.length;
        animateTo(next, 'prev');
      };
  
      const goNext = () => {
        const next = (active + 1) % slides.length;
        animateTo(next, 'next');
      };
  
      prevBtn.addEventListener('click', goPrev);
      nextBtn.addEventListener('click', goNext);
  
      // свайп по изображению (мобильная версия/тач)
      let swipeStartX = 0;
      let swipeStartY = 0;
      let swiping = false;
  
      const swipeThreshold = 28; // px
  
      const onPointerDown = (e) => {
        // только основной палец/кнопка
        if (e.pointerType === 'mouse' && e.button !== 0) return;
        swiping = true;
        swipeStartX = e.clientX;
        swipeStartY = e.clientY;
        try { stageEl.setPointerCapture(e.pointerId); } catch (_) {}
      };
  
      const onPointerUp = (e) => {
        if (!swiping) return;
        swiping = false;
  
        const dx = e.clientX - swipeStartX;
        const dy = e.clientY - swipeStartY;
  
        // если вертикаль доминирует — игнорируем (чтобы скролл работал)
        if (Math.abs(dy) > Math.abs(dx)) return;
        if (Math.abs(dx) < swipeThreshold) return;
  
        if (dx < 0) {
          goNext();
        } else {
          goPrev();
        }
      };
  
      const onPointerCancel = () => { swiping = false; };
  
      if (stageEl) {
        stageEl.addEventListener('pointerdown', onPointerDown);
        stageEl.addEventListener('pointerup', onPointerUp);
        stageEl.addEventListener('pointercancel', onPointerCancel);
        stageEl.addEventListener('pointerleave', onPointerCancel);
      }
  
      renderPagination();
      renderSlideInstant(active);
    });
  </script>

  <style>

    .hero {
      padding: 48px 24px 32px;
      max-width: 1280px;
      margin: 0 auto;
      text-align: center;
    }
    
    .hero__header {
      margin-bottom: 28px;
    }
    
    .hero__subtitle {
      margin: 0;
      color: rgba(255, 255, 255, 0.60);
      text-align: center;
      font-family: "RF Dewi";
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 16px; /* 114.286% */
    }
    
    .hero__title {
      margin: 4px 0 0;
      color: #fff;
      color: var(--0, #FFF);
      text-align: center;
      font-family: "RF Dewi";
      font-size: 48px;
      font-style: normal;
      font-weight: 400;
      line-height: 52px; /* 108.333% */
      letter-spacing: -1.1px;
    }
    
    .hero__visual {
      position: relative;
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 16px;
      padding: 20px 4px 28px
    }
    
    .hero__stage {
      margin: auto;
      position: relative;
      background: transparent;
      padding: 24px 0;
      display: flex;
      justify-content: center;
      align-items: center;
      max-height: 180px;
      max-width: 620px;
    }
    
    .hero__image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      display: block;
      will-change: transform, opacity;
    }
    
    .hero__image--out-left {
      animation: hero-image-out-left 280ms ease forwards;
    }
    
    .hero__image--out-right {
      animation: hero-image-out-right 280ms ease forwards;
    }
    
    .hero__image--in-left {
      animation: hero-image-in-left 280ms ease forwards;
    }
    
    .hero__image--in-right {
      animation: hero-image-in-right 280ms ease forwards;
    }
    
    @keyframes hero-image-out-left {
      from {
        opacity: 1;
        transform: translateX(0);
      }
      to {
        opacity: 0;
        transform: translateX(-40px);
      }
    }
    
    @keyframes hero-image-out-right {
      from {
        opacity: 1;
        transform: translateX(0);
      }
      to {
        opacity: 0;
        transform: translateX(40px);
      }
    }
    
    @keyframes hero-image-in-left {
      from {
        opacity: 0;
        transform: translateX(-40px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    @keyframes hero-image-in-right {
      from {
        opacity: 0;
        transform: translateX(40px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .hero__nav {
      width: 38px;
      height: 48px;
      border-radius: 50%;
      border: 1.2px solid rgba(255, 255, 255, 0.15); 
      background: transparent;
      color: #fff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      position: relative;
      cursor: pointer;
      transition: transform 0.2s ease, border-color 0.2s ease, background 0.2s ease;
    }
    
    .hero__nav:hover {
      transform: scale(1.05);
      border-color: #fff;
      background: rgba(255, 255, 255, 0.08);
    }
    
    .hero__nav:active {
      transform: scale(0.98);
    }
    
    .hero__nav-icon {
      margin-top: -4px;
      font-size: 18px;
      line-height: 1;
      position: relative;
      z-index: 1;
    }
    
    .hero__palette {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 4px;
      flex-wrap: wrap;
    }
    
    .hero__pagination {
      width: 100%;
      margin-top: 0px;
      display: flex;
      justify-content: center;
      gap: 0px;
      min-height: 20px;
    }
    
    /* Мобильная вёрстка по умолчанию: показываем только .mob, скрываем .desktop */
    .hero__pagination.desktop,
    .hero__palette.desktop {
      display: none;
    }
    
    .hero__pagination.mob,
    .hero__palette.mob {
      display: flex;
    }
    
    .hero__dot {
      border: none;
      background: transparent;
      width: 10px;   /* большой hit-area */
      height: 10px;  /* большой hit-area */
      padding: 0;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    
    .hero__dot::before {
      content: "";
      width: 4px;   /* минимальная точка */
      height: 4px;  /* минимальная точка */
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.35);
      display: block;
    }
    
    .hero__dot.is-active::before {
      background: rgba(255, 255, 255, 0.95);
    }
    
    .hero__swatch {
      position: relative;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 1.2px solid rgba(255, 255, 255, 0.15);
      background: transparent;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: border-color 0.2s ease, transform 0.2s ease;
      padding: 0;
    }
    
    .hero__swatch:hover,
    .hero__swatch:focus-visible {
      border-color: rgba(255, 255, 255, 0.6);
      outline: none;
      transform: translateY(-2px);
    }
    
    .hero__swatch-dot {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--swatch-color, #999);
      background-image: var(--swatch-image);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      display: block;
    }
    
    .hero__swatch-tooltip {
      position: absolute;
      left: 50%;
      top: 42px;
      transform: translateX(-50%);
      min-width: 180px;
      max-width: 220px;
      background: transparent;
      color: #fff;
      text-align: left;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.15s ease;
      z-index: 5;
    }
    
    .hero__swatch:hover .hero__swatch-tooltip,
    .hero__swatch:focus-visible .hero__swatch-tooltip {
      opacity: 1;
    }
    
    .hero__swatch-title {
      display: block;
      color: #fff;
      text-align: center;
      font-family: "RF Dewi";
      font-size: 10px;
      font-style: normal;
      font-weight: 400;
      line-height: 14px; /* 140% */
    }
    
    .hero__swatch-desc {
      display: block;
      color: rgba(255, 255, 255, 0.60);
      text-align: center;
      font-family: "RF Dewi";
      font-size: 10px;
      font-style: normal;
      font-weight: 400;
      line-height: 14px; /* 140% */
    }
    
    @media (max-width: 768px) {
      .hero {
        padding: 32px 16px 24px;
      }
    
      .hero__visual {
        grid-template-columns: 1fr;
        gap: 8px;
        padding: 0px;
      }
    
      .hero__nav {
        display: none;
      }
    
      /* стрелки на мобилке скрываем, используем свайп + пагинацию */
    
      .hero__nav--prev {
        left: 8px;
      }
    
      .hero__nav--next {
        right: 8px;
      }
    
      .hero__stage {
        padding: 8px 0px 12px;
        min-height: 100px;
        touch-action: pan-y;
      }
    
      .hero__pagination {
        display: flex;
      }
    }
    
    /* Тач-устройства: скрываем стрелки; пагинация .mob уже управляется шириной экрана */
    @media (hover: none) and (pointer: coarse) {
      .hero__nav {
        display: none !important;
      }
    }
    
    @media (min-width: 1000px) {
        .hero__pagination.mob,
        .hero__palette.mob { display: none !important; }
        .hero__palette.desktop { display: flex; }
        .hero__pagination.desktop { display: none; }
        
        .hero__header {
            position: absolute;
            bottom: 24px;
            left: 0px;
        }
        
        .hero__subtitle {
            text-align: left;
        }
        
        .hero__title {
            text-align: left;
        }
        
        .hero__palette.desktop {
            justify-content: flex-start;
        }
        
        .hero__swatch-title {
            text-align: left;
        }
        
        .hero__swatch-desc {
            text-align: left;
        }
        
        .hero__swatch-tooltip {
            position: absolute;
            left: 46px;
            top: unset;
            transform: unset;
        }
        
        .hero__swatch-tooltip {
            opacity: 1 !important;
        }
        
        .hero__stage {
            margin-top: 92px !important;
        }
        
        .hero__visual {
            padding: 0px;
        }
        
        .hero {
            padding: 64px 0px 0px;
        }
        
        .hero__image {
            margin-left: 148px;
            max-width: 120%;
            max-height: 120%;
        }
    }
    
    @media (max-width: 999px) {
        .hero__pagination.desktop,
        .hero__palette.desktop { display: none !important; }
        .hero__pagination.mob { display: flex !important; }
        .hero__palette.mob { display: flex !important; }
    }
    
    </style>
    